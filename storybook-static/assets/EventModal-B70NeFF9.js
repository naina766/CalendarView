import{j as t}from"./jsx-runtime-u17CrQMm.js";import{r as x}from"./iframe-DECG5Ksn.js";const k=6e4,j=Symbol.for("constructDateFrom");function D(r,s){return typeof r=="function"?r(s):r&&typeof r=="object"&&j in r?r[j](s):r instanceof Date?new r.constructor(s):new Date(s)}function C(r,s){return D(s||r,r)}function d(r,s){const n=r<0?"-":"",o=Math.abs(r).toString().padStart(s,"0");return n+o}function N(r,s){const n=C(r,s?.in);if(isNaN(+n))throw new RangeError("Invalid time value");let o="",m="";const u="-",f=":";{const l=d(n.getDate(),2),a=d(n.getMonth()+1,2);o=`${d(n.getFullYear(),4)}${u}${a}${u}${l}`}{const l=n.getTimezoneOffset();if(l!==0){const h=Math.abs(l),y=d(Math.trunc(h/60),2),e=d(h%60,2);m=`${l<0?"+":"-"}${y}:${e}`}else m="Z";const a=d(n.getHours(),2),p=d(n.getMinutes(),2),i=d(n.getSeconds(),2),g=o===""?"":"T",c=[a,p,i].join(f);o=`${o}${g}${c}${m}`}return o}const b=["#0ea5e9","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"],E=({open:r,initialDate:s,event:n,onSave:o,onDelete:m,onClose:u})=>{const f=x.useRef(null),l=x.useCallback(()=>{const e=n??{title:"",description:"",startDate:s??new Date,endDate:s??new Date,color:b[0],category:""};return{title:e.title,description:e.description??"",start:N(e.startDate).slice(0,16),end:N(e.endDate).slice(0,16),color:e.color??b[0],category:e.category??""}},[n,s]),[a,p]=x.useState(()=>l()),[i,g]=x.useState({});if(x.useEffect(()=>{if(!r)return;const e=setTimeout(()=>{p(l()),g({}),f.current?.focus()},0);return()=>clearTimeout(e)},[r,l]),!r)return null;const c=(e,v)=>{p(w=>({...w,[e]:v}))},h=()=>{const e={};return a.title.trim()||(e.title="Title is required"),a.title.length>100&&(e.title="Max 100 characters"),a.start||(e.start="Start required"),a.end||(e.end="End required"),a.start&&a.end&&new Date(a.start)>=new Date(a.end)&&(e.end="End must be after start"),g(e),Object.keys(e).length===0},y=()=>{if(!h())return;const e={id:n?.id??(typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`${Date.now()}`),title:a.title.trim(),description:a.description.trim()||void 0,startDate:new Date(a.start),endDate:new Date(a.end),color:a.color,category:a.category||void 0};o(e),u()};return t.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[t.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:u}),t.jsxs("div",{className:"relative bg-white rounded-lg p-6 w-full max-w-md shadow-modal",onClick:e=>e.stopPropagation(),children:[t.jsx("h2",{id:"modal-title",className:"text-lg font-semibold mb-3",children:n?"Edit Event":"Create Event"}),t.jsxs("label",{className:"block text-sm mb-2",children:[t.jsx("input",{ref:f,value:a.title,onChange:e=>c("title",e.target.value),placeholder:"Title",maxLength:100,className:"border w-full px-3 py-2 rounded","aria-invalid":!!i.title}),i.title&&t.jsx("div",{className:"text-xs text-red-600 mt-1",children:i.title})]}),t.jsx("label",{className:"block text-sm mb-2",children:t.jsx("textarea",{value:a.description,onChange:e=>c("description",e.target.value),placeholder:"Description (optional)",rows:3,maxLength:500,className:"border w-full px-3 py-2 rounded"})}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("label",{className:"text-sm",children:[t.jsx("div",{className:"text-xs text-neutral-600 mb-1",children:"Start"}),t.jsx("input",{type:"datetime-local",value:a.start,onChange:e=>c("start",e.target.value),className:"border w-full px-2 py-2 rounded","aria-invalid":!!i.start}),i.start&&t.jsx("div",{className:"text-xs text-red-600 mt-1",children:i.start})]}),t.jsxs("label",{className:"text-sm",children:[t.jsx("div",{className:"text-xs text-neutral-600 mb-1",children:"End"}),t.jsx("input",{type:"datetime-local",value:a.end,onChange:e=>c("end",e.target.value),className:"border w-full px-2 py-2 rounded","aria-invalid":!!i.end}),i.end&&t.jsx("div",{className:"text-xs text-red-600 mt-1",children:i.end})]})]}),t.jsxs("div",{className:"mt-3",children:[t.jsx("div",{className:"text-xs text-neutral-600 mb-2",children:"Color"}),t.jsx("div",{className:"flex gap-2",children:b.map(e=>t.jsx("button",{onClick:()=>c("color",e),"aria-pressed":a.color===e,className:`w-8 h-8 rounded-full border ${a.color===e?"ring-2 ring-offset-2 ring-primary-400":""}`,style:{backgroundColor:e}},e))})]}),t.jsxs("label",{className:"block mt-3 text-sm",children:[t.jsx("div",{className:"text-xs text-neutral-600 mb-1",children:"Category"}),t.jsx("input",{value:a.category,onChange:e=>c("category",e.target.value),placeholder:"Category (optional)",className:"border w-full px-2 py-2 rounded"})]}),t.jsxs("div",{className:"mt-5 flex items-center gap-2",children:[t.jsx("button",{onClick:y,className:"bg-primary-600 text-white px-4 py-2 rounded",children:"Save"}),t.jsx("button",{onClick:u,className:"px-3 py-2 rounded border",children:"Cancel"}),n&&m&&t.jsx("button",{onClick:()=>{m(n.id),u()},className:"ml-auto text-sm text-red-600 px-3 py-2",children:"Delete"})]})]})]})};E.__docgenInfo={description:"",methods:[],displayName:"EventModal",props:{open:{required:!0,tsType:{name:"boolean"},description:""},initialDate:{required:!1,tsType:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},description:""},event:{required:!1,tsType:{name:"union",raw:"CalendarEvent | null",elements:[{name:"CalendarEvent"},{name:"null"}]},description:""},onSave:{required:!0,tsType:{name:"signature",type:"function",raw:"(data: CalendarEvent) => void",signature:{arguments:[{type:{name:"CalendarEvent"},name:"data"}],return:{name:"void"}}},description:""},onDelete:{required:!1,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{E,D as c,k as m,C as t};
